<!DOCTYPE html>
<html lang="ko" class="light-mode">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar 고수가 될거야!</title>
    <script src="https://unpkg.com/ml5@0.12.2/dist/ml5.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar centered-nav">
        <div class="nav-switch">
            <button id="nav-tuner">튜너</button>
            <button id="nav-fretboard" class="active">프렛보드</button> 
            <button id="nav-metronome">메트로놈</button>
        </div>
        <div class="nav-controls">
            <div class="volume-control" title="효과음 볼륨">
                <span style="font-size:1.2rem">🔊</span>
                <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="0.5">
            </div>

            <button id="btn-theme" class="icon-btn" title="테마 변경">🌙</button>

            <button id="btn-settings" class="icon-btn" title="오디오 설정">⚙️</button>
        </div>
    </nav>

    <dialog id="settings-modal" class="modal">
        <div class="modal-content">
            <h2>설정</h2>
            <div class="input-select-group">
                <label for="modal-audio-source">입력 장치 선택:</label>
                <select id="modal-audio-source"></select>
            </div>
            <div class="modal-actions">
                <button id="btn-save-settings">저장 & 닫기</button>
                <button id="btn-close-settings" class="secondary-btn">취소</button>
            </div>
        </div>
    </dialog>

    <div id="start-overlay">
        <div class="overlay-content">
            <h1>기타 트레이너</h1>
            <p>실제 줄을 치며 지판을 외웁니다.</p>
            <button id="btn-init">시작하기</button>
            <button id="btn-no-mic">기타 입력 없이 이용</button>
        </div>
    </div>

    <div class="main-container">
        <!-- 튜너 섹션 -->
        <section id="tuner-app" class="app-section hidden">
            <div class="tuner-display">
                <div id="tuner-note">--</div>
                <div id="tuner-freq">0.0 Hz</div>
                <div class="gauge-wrapper">
                    <div class="center-line"></div>
                    <div class="ticks"><span>-50</span><span> </span><span>+50</span></div>
                    <div id="tuner-needle" class="needle"></div>
                </div>
            </div>
        </section>

        <!-- 프렛보드 게임 섹션 -->
        <section id="fretboard-app" class="app-section">
            <div id="game-mode-select" class="mode-selector">
                <h3>모드 선택</h3>
                <div class="mode-cards">
                    <div class="card" data-mode="free"><h4>🌱자유</h4><p>무제한</p></div>
                    <div class="card" data-mode="timeAttack"><h4>⏱️실전</h4><p>100초 타임어택</p></div>
                    <div class="card" data-mode="infinity"><h4>🔥무한</h4><p>5초 컷</p></div>
                </div>
            </div>

            <div id="game-play-area" class="hidden">
                <div class="game-header">
                    <div class="timer-container">
                        <div id="timer-bar" class="bar"></div>
                        <span id="timer-text">--</span>
                    </div>
                    <div class="score-board">SCORE: <span id="score">0</span></div>
                </div>

                <div class="question-box">
                    <div class="target-display">
                        <div id="target-note-display" class="big-note">?</div>
                        <div id="target-string-hint" class="string-hint">-- 번 줄</div>
                    </div>
                    <div class="sustain-bar-bg"><div id="sustain-bar" class="sustain-bar"></div></div>
                    <div id="feedback-msg">대기 중...</div>
                </div>

                <div id="virtual-fretboard" class="virtual-fretboard"></div>

                <div class="controls">
                    <button id="btn-stop-game" class="secondary-btn">나가기</button>
                </div>
            </div>
        </section>

        <!-- 메트로놈 섹션 -->
        <section id="metronome-app" class="app-section hidden">
            <div class="card">
                <h2>Metronome</h2>

                <!-- BPM Display (Input으로 변경됨) -->
                <div class="bpm-display-container">
                    <input type="number" id="metro-bpm-display" value="120" min="20" max="300">
                    <span style="font-size: 1.5rem; color: #7f8c8d;">BPM</span>
                </div>

                <!-- Visual Beats -->
                <div class="metro-visuals">
                    <div class="metro-beat-indicator"></div>
                    <div class="metro-beat-indicator"></div>
                    <div class="metro-beat-indicator"></div>
                    <div class="metro-beat-indicator"></div>
                </div>

                <!-- BPM Controls -->
                <div class="metro-controls">
                    <input type="range" id="metro-bpm-slider" min="20" max="300" value="120">

                    <div class="metro-buttons">
                        <button id="metro-btn-m5" class="secondary-btn">-5</button>
                        <button id="metro-btn-m1" class="secondary-btn">-1</button>
                        <button id="metro-btn-p1" class="secondary-btn">+1</button>
                        <button id="metro-btn-p5" class="secondary-btn">+5</button>
                    </div>                </div>

                <!-- Sound Select & Options -->
                <div class="metro-actions-container" style="display:flex; flex-direction:column; align-items:center; gap:15px; margin-top:20px; width:100%;">

                    <div class="metro-options-row" style="display:flex; gap:20px; align-items:center;">
                        <!-- Sound Select -->
                        <div class="sound-select-wrapper">
                            <label for="metro-sound-select" style="margin-right:5px; font-weight:bold; color:var(--sub-text-color);">Sound:</label>
                            <select id="metro-sound-select" style="padding:5px 10px; border-radius:5px; border:1px solid #555; background:var(--bg-color); color:var(--text-color);">
                                <option value="digital">Digital</option>
                                <option value="click">Click</option>
                                <option value="wood">Wood</option>
                            </select>
                        </div>

                        <!-- [New] First Beat Accent Checkbox -->
                        <div class="accent-check-wrapper" style="display:flex; align-items:center; gap:5px;">
                            <input type="checkbox" id="metro-accent-check" checked style="width:18px; height:18px; cursor:pointer; accent-color:var(--accent-color);">
                            <label for="metro-accent-check" style="cursor:pointer; font-weight:bold; color:var(--sub-text-color);">Accent</label>
                        </div>
                    </div>

                    <div class="metro-actions">
                        <button id="metro-btn-start" class="primary-btn" style="width: 120px;">START</button>
                        <button id="metro-btn-tap" class="secondary-btn" style="width: 80px;">TAP</button>
                    </div>
                </div>

                <!-- Volume -->
                <div class="metro-volume-container">
                    <label>Metronome Vol</label>
                    <input type="range" id="metro-volume" min="0" max="100" value="50">
                </div>
            </div>
        </section>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>